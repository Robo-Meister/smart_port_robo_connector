{
  "schema_version": "1.0",
  "actions": [
    {
      "action_id": "assemble_candidate_rebooking_plan",
      "input_contract": [
        "$.booking.shipment_id",
        "$.booking.top_3_alternatives"
      ],
      "output_contract": [
        "$.booking.rebooking_plan_id"
      ],
      "side_effects": [
        "creates draft rebooking plan"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 20
      },
      "security": {
        "access": "operations",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "assign_driver",
      "input_contract": [
        "$.booking.container.container_id",
        "$.booking.slot_chain.slot_chain_id",
        "$.booking.carrier_id"
      ],
      "output_contract": [
        "$.booking.driver_id",
        "$.booking.driver_assignment_status"
      ],
      "side_effects": [
        "reserves driver capacity"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 20
      },
      "security": {
        "access": "dispatch",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "capture_anpr_read",
      "input_contract": [
        "$.booking.vehicle.license_plate",
        "$.booking.facility.gate_id"
      ],
      "output_contract": [
        "$.booking.vehicle.anpr_read"
      ],
      "side_effects": [
        "captures ANPR snapshot"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 2
      },
      "security": {
        "access": "gate_ops",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "capture_destination_change_approval",
      "input_contract": [
        "$.booking.shipment_id",
        "$.booking.destination_change",
        "$.policy.approver"
      ],
      "output_contract": [
        "$.booking.destination_change_approval_id"
      ],
      "side_effects": [
        "records customer approval"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 120
      },
      "security": {
        "access": "customer_success",
        "data_classification": "restricted"
      }
    },
    {
      "action_id": "confirm_new_slot",
      "input_contract": [
        "$.booking.slot_request_id",
        "$.booking.container.container_id",
        "$.booking.requested_window"
      ],
      "output_contract": [
        "$.booking.slot_id"
      ],
      "side_effects": [
        "books slot with terminal"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 15
      },
      "security": {
        "access": "scheduling",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "confirm_slot_chain",
      "input_contract": [
        "$.booking.slot_chain.slot_chain_id",
        "$.booking.requested_window"
      ],
      "output_contract": [
        "$.booking.slot_chain.confirmation_status"
      ],
      "side_effects": [
        "books slot chain with terminal"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 15
      },
      "security": {
        "access": "scheduling",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "detect_inbound_shipment",
      "input_contract": [
        "$.booking.container.container_id",
        "$.booking.arrival_eta",
        "$.booking.facility.port_code"
      ],
      "output_contract": [
        "$.booking.shipment_id",
        "$.booking.detected_at"
      ],
      "side_effects": [
        "ingests inbound shipment event"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 5
      },
      "security": {
        "access": "port_ops",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "emit_gate_event",
      "input_contract": [
        "$.booking.container.container_id",
        "$.booking.facility.gate_id"
      ],
      "output_contract": [
        "$.tracking.events[]"
      ],
      "side_effects": [
        "emits gate event notification"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 1
      },
      "security": {
        "access": "gate_ops",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "generate_what_if_preview",
      "input_contract": [
        "$.booking.shipment_id",
        "$.booking.rebooking_plan_id",
        "$.policy.cost_model"
      ],
      "output_contract": [
        "$.booking.eta_impact",
        "$.booking.cost_impact",
        "$.booking.sla_risk"
      ],
      "side_effects": [
        "reads pricing and SLA data"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 15
      },
      "security": {
        "access": "operations",
        "data_classification": "sensitive"
      }
    },
    {
      "action_id": "handle_insufficient_rebooking_alternatives",
      "input_contract": [
        "$.booking.ranked_alternatives",
        "$.policy.minimum_required"
      ],
      "output_contract": [
        "$.booking.alternative_shortfall"
      ],
      "side_effects": [
        "flags insufficient rebooking alternatives"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 5
      },
      "security": {
        "access": "operations",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "ingest_gate_arrival",
      "input_contract": [
        "$.booking.container.container_id",
        "$.booking.facility.gate_id",
        "$.booking.driver_id"
      ],
      "output_contract": [
        "$.booking.gate_events.last_arrival_at"
      ],
      "side_effects": [
        "records gate arrival intent"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 2
      },
      "security": {
        "access": "gate_ops",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "ingest_gate_departure",
      "input_contract": [
        "$.booking.container.container_id",
        "$.booking.facility.gate_id",
        "$.booking.driver_id"
      ],
      "output_contract": [
        "$.booking.gate_events.last_departure_at"
      ],
      "side_effects": [
        "records gate departure intent"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 2
      },
      "security": {
        "access": "gate_ops",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "notify_stakeholders",
      "input_contract": [
        "$.booking.shipment_id",
        "$.policy.notification_channels"
      ],
      "output_contract": [
        "$.audit.notifications"
      ],
      "side_effects": [
        "sends notifications"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 5
      },
      "security": {
        "access": "communications",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "open_gate_barrier",
      "input_contract": [
        "$.booking.facility.gate_id"
      ],
      "output_contract": [
        "$.booking.gate_events.barrier_opened_at"
      ],
      "side_effects": [
        "opens gate barrier"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 1
      },
      "security": {
        "access": "gate_ops",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "rank_rebooking_alternatives",
      "input_contract": [
        "$.booking.alternatives",
        "$.policy.guardrail_policy",
        "$.policy.cost_model",
        "$.policy.sla_thresholds",
        "$.policy.ranking_weights"
      ],
      "output_contract": [
        "$.booking.ranked_alternatives",
        "$.booking.top_3_alternatives"
      ],
      "side_effects": [
        "scores and ranks rebooking alternatives"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 8
      },
      "security": {
        "access": "operations",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "read_scale_weight",
      "input_contract": [
        "$.booking.container.container_id",
        "$.booking.facility.scale_id"
      ],
      "output_contract": [
        "$.booking.container.scale_weight"
      ],
      "side_effects": [
        "reads scale weight"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 2
      },
      "security": {
        "access": "gate_ops",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "record_gate_check_in",
      "input_contract": [
        "$.booking.container.container_id",
        "$.booking.facility.gate_id"
      ],
      "output_contract": [
        "$.booking.gate_events.last_check_in_at"
      ],
      "side_effects": [
        "records gate check-in event"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 2
      },
      "security": {
        "access": "gate_ops",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "record_gate_check_out",
      "input_contract": [
        "$.booking.container.container_id",
        "$.booking.facility.gate_id"
      ],
      "output_contract": [
        "$.booking.gate_events.last_check_out_at"
      ],
      "side_effects": [
        "records gate check-out event"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 2
      },
      "security": {
        "access": "gate_ops",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "reserve_resource_chain",
      "input_contract": [
        "$.booking.slot_chain.slot_chain_id",
        "$.resources[]"
      ],
      "output_contract": [
        "$.booking.slot_chain.reservation_id",
        "$.booking.slot_chain.reservation_status"
      ],
      "side_effects": [
        "reserves resource chain capacity"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 15
      },
      "security": {
        "access": "scheduling",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "route_for_operations_approval",
      "input_contract": [
        "$.booking.rebooking_plan_id",
        "$.policy.approver_group"
      ],
      "output_contract": [
        "$.booking.approval_request_id"
      ],
      "side_effects": [
        "creates approval request"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 30
      },
      "security": {
        "access": "operations",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "scan_qr_token",
      "input_contract": [
        "$.booking.driver_id",
        "$.booking.facility.gate_id"
      ],
      "output_contract": [
        "$.booking.driver.qr_scan"
      ],
      "side_effects": [
        "scans QR token"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 2
      },
      "security": {
        "access": "gate_ops",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "scan_rfid_badge",
      "input_contract": [
        "$.booking.driver_id",
        "$.booking.facility.gate_id"
      ],
      "output_contract": [
        "$.booking.driver.badge_scan"
      ],
      "side_effects": [
        "scans RFID badge"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 2
      },
      "security": {
        "access": "gate_ops",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "show_alternative_ports_or_slot_chains",
      "input_contract": [
        "$.booking.shipment_id",
        "$.constraints",
        "$.booking.slot_chain.stages[]"
      ],
      "output_contract": [
        "$.booking.alternatives",
        "$.booking.slot_chain.candidates"
      ],
      "side_effects": [
        "reads port and slot chain capacity data"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 12
      },
      "security": {
        "access": "operations",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "show_alternative_ports_or_slots",
      "input_contract": [
        "$.booking.shipment_id",
        "$.constraints"
      ],
      "output_contract": [
        "$.booking.alternatives"
      ],
      "side_effects": [
        "reads port capacity data"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 10
      },
      "security": {
        "access": "operations",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "suggest_slot_chain",
      "input_contract": [
        "$.booking.container.container_id",
        "$.booking.arrival_eta",
        "$.booking.requested_window",
        "$.booking.slot_chain.stages[]",
        "$.constraints.mode"
      ],
      "output_contract": [
        "$.booking.slot_chain.candidates",
        "$.booking.slot_chain.slot_chain_id"
      ],
      "side_effects": [
        "queries slot chain inventory"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 12
      },
      "security": {
        "access": "scheduling",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "suggest_time_slots",
      "input_contract": [
        "$.booking.container.container_id",
        "$.booking.arrival_eta",
        "$.booking.requested_window",
        "$.constraints.mode"
      ],
      "output_contract": [
        "$.booking.slot_candidates"
      ],
      "side_effects": [
        "queries slot inventory"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 10
      },
      "security": {
        "access": "scheduling",
        "data_classification": "operational"
      }
    },
    {
      "action_id": "update_etas",
      "input_contract": [
        "$.booking.shipment_id",
        "$.booking.new_eta"
      ],
      "output_contract": [
        "$.booking.previous_eta",
        "$.booking.updated_eta"
      ],
      "side_effects": [
        "updates customer ETA data"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 10
      },
      "security": {
        "access": "operations",
        "data_classification": "sensitive"
      }
    },
    {
      "action_id": "validate_documents",
      "input_contract": [
        "$.booking.shipment_id",
        "$.documents.required[]",
        "$.documents.blocking_rules[]"
      ],
      "output_contract": [
        "$.documents.status",
        "$.documents.issues"
      ],
      "side_effects": [
        "reads compliance documents"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 15
      },
      "security": {
        "access": "compliance",
        "data_classification": "restricted"
      }
    },
    {
      "action_id": "validate_exit_authorization",
      "input_contract": [
        "$.booking.container.container_id",
        "$.booking.driver_id"
      ],
      "output_contract": [
        "$.booking.exit_authorization.status"
      ],
      "side_effects": [
        "validates exit authorization"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 5
      },
      "security": {
        "access": "security",
        "data_classification": "restricted"
      }
    },
    {
      "action_id": "validate_gate_credentials",
      "input_contract": [
        "$.booking.container.container_id",
        "$.booking.driver_id"
      ],
      "output_contract": [
        "$.booking.gate_access.status"
      ],
      "side_effects": [
        "validates gate credentials"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 5
      },
      "security": {
        "access": "security",
        "data_classification": "restricted"
      }
    },
    {
      "action_id": "validate_rebooking_guardrails",
      "input_contract": [
        "$.booking.rebooking_plan_id",
        "$.policy.guardrail_policy"
      ],
      "output_contract": [
        "$.booking.guardrail_status",
        "$.booking.guardrail_violations"
      ],
      "side_effects": [
        "evaluates policy rules"
      ],
      "idempotency_key": "$.booking.reference_id",
      "sla": {
        "response_time_minutes": 10
      },
      "security": {
        "access": "compliance",
        "data_classification": "sensitive"
      }
    }
  ]
}
